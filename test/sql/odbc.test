# name: test/sql/odbc.test
# description: test odbc extension
# group: [odbc]

# Require statement will ensure this test is run with this extension loaded
require odbc

statement ok
set variable odbc_connection = (select case platform when 'osx_arm64' then 'Driver={SQLite Driver};Database=:memory:' else 'Driver={DuckDB Driver};Database=:memory:;' end con from pragma_platform())

# Confirm the extension works with connection string
query I
FROM odbc_query(getvariable('odbc_connection'),'SELECT 42 AS Answer');
----
42

# Confirm the extension can work with more than 2048 rows
query I
SELECT count(*) FROM odbc_query(getvariable('odbc_connection'),'WITH RECURSIVE seq(n) AS (
  SELECT 1
  UNION ALL
  SELECT n+1
    FROM seq
   WHERE n < 3000)
SELECT n
FROM seq;');
----
3000
